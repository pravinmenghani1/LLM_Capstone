<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoTech Auto-Scorer - Production Ready</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 10px; text-align: center; margin-bottom: 30px; }
        .upload-section { background: white; border-radius: 10px; padding: 25px; margin: 20px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        
        /* Enhanced textarea with better UX */
        textarea { 
            width: 100%; min-height: 120px; padding: 15px; border: 2px solid #e1e8ed; border-radius: 8px; 
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace; font-size: 14px; margin: 10px 0; 
            resize: vertical; transition: border-color 0.2s ease; line-height: 1.5;
        }
        textarea:focus { border-color: #3498db; outline: none; box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1); }
        
        /* Improved buttons with accessibility */
        .btn { 
            padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; 
            margin: 8px 4px; transition: all 0.2s ease; font-weight: 500; position: relative;
        }
        .btn:focus { outline: 2px solid #3498db; outline-offset: 2px; }
        .btn-primary { background: #3498db; color: white; }
        .btn-primary:hover { background: #2980b9; transform: translateY(-1px); }
        .btn-success { background: #27ae60; color: white; }
        .btn-success:hover { background: #229954; transform: translateY(-1px); }
        
        .scoring-results { background: white; border-radius: 10px; padding: 25px; margin: 20px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: none; }
        
        /* Animated progress circle */
        .progress-circle { 
            width: 120px; height: 120px; border-radius: 50%; display: flex; align-items: center; 
            justify-content: center; font-size: 18px; font-weight: bold; margin: 0 auto; 
            flex-direction: column; transition: all 0.5s ease; position: relative; cursor: pointer;
        }
        .progress-circle:hover { transform: scale(1.05); }
        
        /* Enhanced score items */
        .score-item { 
            padding: 20px; margin: 15px 0; border-radius: 12px; transition: all 0.3s ease; 
            border: 2px solid transparent; position: relative;
        }
        .score-item:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .score-excellent { background: linear-gradient(135deg, #d4edda, #c3e6cb); color: #155724; border-color: #27ae60; }
        .score-good { background: linear-gradient(135deg, #d1ecf1, #bee5eb); color: #0c5460; border-color: #3498db; }
        .score-warning { background: linear-gradient(135deg, #fff3cd, #ffeaa7); color: #856404; border-color: #f39c12; }
        .score-poor { background: linear-gradient(135deg, #f8d7da, #f5c6cb); color: #721c24; border-color: #e74c3c; }
        
        /* Responsive grid */
        .artifact-grid { 
            display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; 
        }
        @media (max-width: 768px) {
            .artifact-grid { grid-template-columns: 1fr; }
            .container { padding: 10px; }
            .header { padding: 20px; }
        }
        
        /* Enhanced improvement suggestions */
        .improvement-suggestions {
            font-size: 14px; color: #2c3e50; margin-top: 12px; padding: 12px 16px; 
            border-radius: 8px; line-height: 1.5; position: relative; animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .improvement-suggestions.excellent { background: linear-gradient(135deg, #e8f5e9, #f1f8e9); border-left: 4px solid #27ae60; }
        .improvement-suggestions.warning { background: linear-gradient(135deg, #fff8e1, #fffde7); border-left: 4px solid #ff9800; }
        .improvement-suggestions.poor { background: linear-gradient(135deg, #ffebee, #fce4ec); border-left: 4px solid #f44336; }
        .improvement-suggestions:not(.excellent):not(.warning):not(.poor) { background: linear-gradient(135deg, #f0f4f8, #e3f2fd); border-left: 4px solid #3498db; }
        
        /* Tooltip system */
        .tooltip { position: relative; display: inline-block; }
        .tooltip .tooltiptext {
            visibility: hidden; width: 200px; background-color: #333; color: #fff; text-align: center;
            border-radius: 6px; padding: 8px; position: absolute; z-index: 1; bottom: 125%; left: 50%;
            margin-left: -100px; opacity: 0; transition: opacity 0.3s; font-size: 12px;
        }
        .tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }
        
        .debug-info { background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; margin: 15px 0; font-family: monospace; font-size: 13px; display: none; }
        .debug-section { margin: 15px 0; padding: 10px; background: white; border-radius: 6px; border-left: 4px solid #3498db; }
        
        /* Loading state */
        .loading { opacity: 0.6; pointer-events: none; }
        .btn.loading::after {
            content: ''; width: 16px; height: 16px; margin-left: 8px; border: 2px solid transparent;
            border-top: 2px solid currentColor; border-radius: 50%; animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ EcoTech Auto-Scorer Pro</h1>
            <p>Advanced Interactive Quality Assessment System</p>
            <p style="font-size: 14px; opacity: 0.9; margin-top: 10px;">Production-ready scoring with accessibility and mobile support</p>
        </div>

        <div class="upload-section">
            <h2>üìã Submit Your Team's Artifacts</h2>
            <p style="margin-bottom: 20px;">Paste your work below for instant scoring and personalized improvement suggestions.</p>
            
            <div class="artifact-grid">
                <div>
                    <h3>üåç Content Creation (30 points)</h3>
                    <textarea id="translations" 
                        placeholder="Expected format:
English: AquaPure Solar - Revolutionary water purification device...
Spanish: AquaPure Solar - Dispositivo revolucionario...
Japanese: AquaPure Solar - Èù©Êñ∞ÁöÑ„Å™Ê∞¥Ë≥™ÊµÑÂåñË£ÖÁΩÆ...
German: AquaPure Solar - Revolution√§res Wasserreinigungsger√§t...
Hindi: AquaPure Solar - ‡§ï‡•ç‡§∞‡§æ‡§Ç‡§§‡§ø‡§ï‡§æ‡§∞‡•Ä ‡§ú‡§≤ ‡§∂‡•Å‡§¶‡•ç‡§ß‡•Ä‡§ï‡§∞‡§£ ‡§â‡§™‡§ï‡§∞‡§£..."
                        aria-label="Product translations in 5 languages"></textarea>
                    
                    <textarea id="linkedin" 
                        placeholder="Expected format:
Maria Santos: Regional Sales Manager - Southern Europe...
Hiroshi Tanaka: Regional Sales Manager - Asia Pacific...
Priya Sharma: Regional Sales Manager - South Asia..."
                        aria-label="LinkedIn profiles for sales team"></textarea>
                </div>
                
                <div>
                    <h3>üí¨ Customer Intelligence (25 points)</h3>
                    <textarea id="sentiment" 
                        placeholder="Expected format:
Review 1: Score: 0.95, Emotion: Excitement, Action: Feature in testimonials
Review 2: Score: 0.65, Emotion: Disappointment, Action: Investigate
Overall Summary: Average sentiment 0.63, 40% positive, 20% negative
Top Issues: Device reliability, performance claims
Response Templates: Created for positive, negative, mixed reviews"
                        aria-label="Sentiment analysis results"></textarea>
                    
                    <h3>‚ö° Automation Setup (25 points)</h3>
                    <textarea id="workflows" 
                        placeholder="Expected format:
Customer Support Workflow:
Trigger: New support ticket received
Steps: Extract info, analyze sentiment, categorize, route
Escalation Rules: Negative sentiment + technical = urgent

Social Media Workflow:
Trigger: Brand mention detected
Steps: Extract details, analyze sentiment, generate response"
                        aria-label="Workflow automation designs"></textarea>
                </div>
            </div>

            <h3>üîç Data Quality (20 points)</h3>
            <textarea id="validation" 
                placeholder="Expected format:
Consistency Check: Weight 2.5kg consistent, purification rate 99.9% consistent
Translation Quality: Spanish 9.5/10, Japanese 8.7/10, German 9.2/10, Hindi 6.5/10
Average: 8.5/10
Issues Found: Minor pricing discrepancy
Critical Issues: None - all technical specs match"
                aria-label="Quality validation results"></textarea>

            <div style="text-align: center; margin: 30px 0;">
                <button class="btn btn-primary" onclick="startAutoScoring()" aria-label="Start automatic scoring of submitted artifacts">
                    ü§ñ Start Auto-Scoring
                </button>
                <button class="btn btn-success" onclick="loadSampleData()" aria-label="Load sample data for testing">
                    üìù Load Sample Data
                </button>
            </div>
        </div>

        <div class="scoring-results" id="scoring-results" role="region" aria-label="Scoring results">
            <h2>üìä Interactive Scoring Results</h2>
            
            <div style="text-align: center; margin: 30px 0;">
                <div class="progress-circle tooltip" id="overall-score" role="button" tabindex="0" aria-label="Overall score circle">
                    <span class="tooltiptext">Click for detailed breakdown</span>
                    <div>-</div>
                </div>
                <h3 id="score-label">Overall Score</h3>
                <div id="launch-decision" style="font-size: 18px; font-weight: bold; margin: 20px 0;" role="status" aria-live="polite">
                    Complete scoring to see recommendation
                </div>
            </div>

            <div id="detailed-scores" role="region" aria-label="Category scores">
                <div class="score-item" id="content-score">
                    <div style="flex: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span><strong>üåç Content Quality (30 points)</strong></span>
                            <span id="content-points" aria-label="Content quality score">-/30</span>
                        </div>
                        <div id="content-improvements" class="improvement-suggestions" role="region" aria-label="Content improvement suggestions"></div>
                    </div>
                </div>
                <div class="score-item" id="intelligence-score">
                    <div style="flex: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span><strong>üí¨ Customer Intelligence (25 points)</strong></span>
                            <span id="intelligence-points" aria-label="Customer intelligence score">-/25</span>
                        </div>
                        <div id="intelligence-improvements" class="improvement-suggestions" role="region" aria-label="Intelligence improvement suggestions"></div>
                    </div>
                </div>
                <div class="score-item" id="automation-score">
                    <div style="flex: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span><strong>‚ö° Automation Setup (25 points)</strong></span>
                            <span id="automation-points" aria-label="Automation setup score">-/25</span>
                        </div>
                        <div id="automation-improvements" class="improvement-suggestions" role="region" aria-label="Automation improvement suggestions"></div>
                    </div>
                </div>
                <div class="score-item" id="quality-score">
                    <div style="flex: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span><strong>üîç Data Quality (20 points)</strong></span>
                            <span id="quality-points" aria-label="Data quality score">-/20</span>
                        </div>
                        <div id="quality-improvements" class="improvement-suggestions" role="region" aria-label="Quality improvement suggestions"></div>
                    </div>
                </div>
            </div>

            <div class="debug-info" id="debug-info" role="region" aria-label="Debug information">
                <div id="debug-content"></div>
            </div>

            <div style="text-align: center; margin: 30px 0;">
                <button class="btn btn-success" onclick="toggleDebug()" aria-label="Toggle debug information display">
                    üîß Show Debug Info
                </button>
                <button class="btn btn-primary" onclick="exportResults()" aria-label="Export scoring results">
                    üìã Export Results
                </button>
                <button class="btn btn-success" onclick="generateReport()" aria-label="Generate detailed report">
                    üìä Generate Report
                </button>
            </div>
        </div>
    </div>
    <script>
        // Unified data structure for better maintainability
        let assessmentData = {
            scores: { content: 0, intelligence: 0, automation: 0, quality: 0, total: 0 },
            debug: { content: [], intelligence: [], automation: [], quality: [] },
            suggestions: { content: [], intelligence: [], automation: [], quality: [] },
            metadata: { timestamp: null, teamName: '', processingTime: 0 }
        };

        // Parameterized scoring thresholds
        const SCORE_THRESHOLDS = {
            excellent: 80, good: 60, warning: 40, poor: 0
        };

        // Performance-optimized scoring with caching
        const scoringCache = new Map();
        
        function getCacheKey(text) {
            return btoa(text.substring(0, 100)).replace(/[^a-zA-Z0-9]/g, '');
        }

        function loadSampleData() {
            const sampleData = {
                translations: `English: AquaPure Solar - Revolutionary water purification device. Solar-powered operation, 99.9% bacteria removal, portable (2.5kg), 10L/hour capacity, IoT monitoring.

Spanish: AquaPure Solar - Dispositivo revolucionario de purificaci√≥n de agua. Funcionamiento solar, eliminaci√≥n 99.9% bacterias, port√°til (2.5kg), capacidad 10L/hora.

Japanese: AquaPure Solar - Èù©Êñ∞ÁöÑ„Å™Ê∞¥Ë≥™ÊµÑÂåñË£ÖÁΩÆ„ÄÇ„ÇΩ„Éº„É©„ÉºÈßÜÂãï„ÄÅ99.9%„Éê„ÇØ„ÉÜ„É™„Ç¢Èô§Âéª„ÄÅ„Éù„Éº„Çø„Éñ„É´(2.5kg)„ÄÅ10L/ÊôÇÈñìÂÆπÈáè„ÄÇ

German: AquaPure Solar - Revolution√§res Wasserreinigungsger√§t. Solarbetrieb, 99,9% Bakterienentfernung, tragbar (2,5kg), 10L/Stunde.

Hindi: AquaPure Solar - ‡§ï‡•ç‡§∞‡§æ‡§Ç‡§§‡§ø‡§ï‡§æ‡§∞‡•Ä ‡§ú‡§≤ ‡§∂‡•Å‡§¶‡•ç‡§ß‡•Ä‡§ï‡§∞‡§£ ‡§â‡§™‡§ï‡§∞‡§£‡•§ ‡§∏‡•ã‡§≤‡§∞ ‡§∏‡§Ç‡§ö‡§æ‡§≤‡§ø‡§§, 99.9% ‡§¨‡•à‡§ï‡•ç‡§ü‡•Ä‡§∞‡§ø‡§Ø‡§æ ‡§π‡§ü‡§æ‡§®‡§æ, ‡§™‡•ã‡§∞‡•ç‡§ü‡•á‡§¨‡§≤ (2.5kg)‡•§`,

                linkedin: `Maria Santos: Regional Sales Manager - Southern Europe at EcoTech Solutions. 5+ Years B2B Sales Leadership. MBA from Universidad de Barcelona. Increased regional sales by 150%.

Hiroshi Tanaka: Regional Sales Manager - Asia Pacific at EcoTech Solutions. 8+ Years Tech Sales. Engineering background from Tokyo Institute of Technology. Led $5M solar technology rollout.

Priya Sharma: Regional Sales Manager - South Asia at EcoTech Solutions. 6+ Years Impact-Driven Sales. MS Environmental Engineering from IIT Delhi. Implemented water solutions for 100+ communities.`,

                sentiment: `Sentiment Analysis Results:
Review 1: Score: 0.95, Emotion: Excitement, Action: Feature in testimonials, Priority: High
Review 2: Score: 0.65, Emotion: Disappointment, Action: Investigate performance claims, Priority: Medium
Review 3: Score: 0.15, Emotion: Anger, Action: Immediate escalation, Priority: Urgent
Overall Summary: Average sentiment 0.63/1.0, 40% positive, 20% negative
Top 3 Issues: Device reliability, performance claims, customer service
Response Templates: Created professional templates for positive, negative, and mixed sentiment responses`,

                workflows: `Customer Support Workflow:
Trigger: New support ticket received via email
Steps: 1) Extract ticket info, 2) Analyze sentiment with ChatGPT, 3) Categorize issue type, 4) Set priority level, 5) Route to appropriate team, 6) Send auto-acknowledgment
Escalation Rules: Sentiment <0.3 + Technical = Urgent, Multiple tickets = Manager alert

Social Media Workflow:
Trigger: Brand mention detected on social platforms
Steps: 1) Extract mention details, 2) Analyze sentiment, 3) Determine response strategy, 4) Generate response, 5) Route for approval if negative
Response Templates: Positive and negative response templates created`,

                validation: `Quality Validation Results:
Consistency Check: Weight 2.5kg consistent across all languages, Purification rate 99.9% consistent, Company name "EcoTech Solutions" correct
Translation Quality Scores: Spanish 9.5/10 (Excellent), Japanese 8.7/10 (Good), German 9.2/10 (Excellent), Hindi 6.5/10 (Needs work)
Average Translation Quality: 8.5/10 - Launch ready for most markets
Issues Found: Minor EUR pricing discrepancy, Hindi cultural tone needs adjustment
Critical Issues: None found - all technical specifications match`
            };

            Object.keys(sampleData).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = sampleData[key];
                    element.style.borderColor = '#27ae60';
                    setTimeout(() => element.style.borderColor = '#e1e8ed', 1000);
                }
            });

            showNotification('‚úÖ Sample data loaded successfully!', 'success');
        }

        // Enhanced scoring functions with performance optimization
        function scoreContentQuality(translations, linkedin) {
            const cacheKey = getCacheKey(translations + linkedin);
            if (scoringCache.has(cacheKey)) {
                return scoringCache.get(cacheKey);
            }

            let score = 0;
            let debug = [];

            // Language detection with weighted scoring
            const languagePatterns = [
                { name: 'English', patterns: ['english', 'aquapure solar', 'revolutionary'], weight: 3 },
                { name: 'Spanish', patterns: ['spanish', 'dispositivo', 'purificaci√≥n'], weight: 3 },
                { name: 'Japanese', patterns: ['japanese', 'Èù©Êñ∞ÁöÑ', 'Ê∞¥Ë≥™ÊµÑÂåñ'], weight: 3 },
                { name: 'German', patterns: ['german', 'wasserreinigung', 'revolution√§r'], weight: 3 },
                { name: 'Hindi', patterns: ['hindi', '‡§â‡§™‡§ï‡§∞‡§£', '‡§∂‡•Å‡§¶‡•ç‡§ß‡•Ä‡§ï‡§∞‡§£'], weight: 3 }
            ];

            languagePatterns.forEach(lang => {
                const matches = lang.patterns.filter(p => translations.toLowerCase().includes(p.toLowerCase())).length;
                if (matches >= 2) {
                    score += lang.weight;
                    debug.push(`${lang.name} detected ‚Üí +${lang.weight} pts`);
                }
            });

            // Technical specifications
            const techSpecs = [
                { term: '99.9', points: 2, name: 'Purification rate' },
                { term: '2.5', points: 2, name: 'Weight' },
                { term: '10l', points: 1.5, name: 'Capacity' },
                { term: 'solar', points: 1.5, name: 'Power source' },
                { term: 'iot', points: 1, name: 'IoT features' }
            ];

            techSpecs.forEach(spec => {
                if (translations.toLowerCase().includes(spec.term.toLowerCase())) {
                    score += spec.points;
                    debug.push(`${spec.name} "${spec.term}" ‚Üí +${spec.points} pts`);
                }
            });

            // LinkedIn profiles
            const profiles = ['maria', 'hiroshi', 'priya'];
            profiles.forEach(name => {
                if (linkedin.toLowerCase().includes(name)) {
                    score += 2;
                    debug.push(`${name} profile detected ‚Üí +2 pts`);
                }
            });

            const result = { score: Math.min(30, Math.round(score)), debug };
            scoringCache.set(cacheKey, result);
            return result;
        }

        function scoreCustomerIntelligence(sentiment) {
            let score = 0;
            let debug = [];

            const keywords = [
                { word: 'score', points: 2.5, category: 'Scoring' },
                { word: 'sentiment', points: 2.5, category: 'Analysis' },
                { word: 'emotion', points: 2, category: 'Emotion Detection' },
                { word: 'action', points: 2, category: 'Action Planning' },
                { word: 'priority', points: 1.5, category: 'Prioritization' },
                { word: 'overall', points: 2, category: 'Summary' },
                { word: 'template', points: 1.5, category: 'Response Templates' }
            ];

            keywords.forEach(item => {
                if (sentiment.toLowerCase().includes(item.word)) {
                    score += item.points;
                    debug.push(`${item.category} "${item.word}" ‚Üí +${item.points} pts`);
                }
            });

            return { score: Math.min(25, Math.round(score)), debug };
        }

        function scoreAutomationSetup(workflows) {
            let score = 0;
            let debug = [];

            const keywords = [
                { word: 'customer', points: 3, category: 'Customer Support' },
                { word: 'support', points: 2.5, category: 'Support System' },
                { word: 'social', points: 3, category: 'Social Media' },
                { word: 'trigger', points: 2.5, category: 'Trigger Definition' },
                { word: 'step', points: 2, category: 'Process Steps' },
                { word: 'escalation', points: 3, category: 'Escalation Rules' }
            ];

            keywords.forEach(item => {
                if (workflows.toLowerCase().includes(item.word)) {
                    score += item.points;
                    debug.push(`${item.category} "${item.word}" ‚Üí +${item.points} pts`);
                }
            });

            return { score: Math.min(25, Math.round(score)), debug };
        }

        function scoreDataQuality(validation) {
            let score = 0;
            let debug = [];

            const keywords = [
                { word: 'consistent', points: 2.5, category: 'Consistency Check' },
                { word: 'quality', points: 2, category: 'Quality Assessment' },
                { word: '/10', points: 3, category: 'Numerical Scoring' },
                { word: 'average', points: 2.5, category: 'Average Calculation' },
                { word: 'issues', points: 2, category: 'Issue Identification' },
                { word: 'critical', points: 2.5, category: 'Critical Analysis' }
            ];

            keywords.forEach(item => {
                if (validation.toLowerCase().includes(item.word)) {
                    score += item.points;
                    debug.push(`${item.category} "${item.word}" ‚Üí +${item.points} pts`);
                }
            });

            return { score: Math.min(20, Math.round(score)), debug };
        }

        // Parameterized suggestion class function
        function getSuggestionClass(score, maxScore) {
            const percentage = (score / maxScore) * 100;
            if (percentage >= SCORE_THRESHOLDS.excellent) return 'excellent';
            if (percentage >= SCORE_THRESHOLDS.good) return '';
            if (percentage >= SCORE_THRESHOLDS.warning) return 'warning';
            return 'poor';
        }

        // Enhanced suggestion generator with more specific guidance
        function generateSuggestions() {
            const suggestions = {};
            const scores = assessmentData.scores;

            // Content Quality
            const contentPercentage = (scores.content / 30) * 100;
            suggestions.content = [];
            
            if (contentPercentage < 60) {
                suggestions.content.push("üîç Include all 5 language translations with key technical terms: '99.9%', '2.5kg', '10L/hour', 'IoT'");
                suggestions.content.push("üë• Add complete LinkedIn profiles for Maria Santos, Hiroshi Tanaka, and Priya Sharma with specific achievements");
                suggestions.content.push("üåç Ensure cultural adaptation for each market, not just literal translation");
            } else if (contentPercentage < 80) {
                suggestions.content.push("‚ú® Enhance technical specifications and add more IoT features");
                suggestions.content.push("üìà Include quantifiable achievements in LinkedIn profiles (percentages, dollar amounts)");
            } else {
                suggestions.content.push("üéâ Outstanding content quality! Your translations and profiles are excellent");
            }

            // Customer Intelligence
            const intelligencePercentage = (scores.intelligence / 25) * 100;
            suggestions.intelligence = [];
            
            if (intelligencePercentage < 60) {
                suggestions.intelligence.push("üìä Include specific sentiment scores (0.0-1.0) and emotions for each review");
                suggestions.intelligence.push("üéØ Add clear action recommendations: 'escalate', 'investigate', 'feature in testimonials'");
                suggestions.intelligence.push("üìà Provide overall summary with average sentiment and top 3 issues");
            } else if (intelligencePercentage < 80) {
                suggestions.intelligence.push("üîß Add detailed priority levels (urgent, high, medium, low)");
                suggestions.intelligence.push("üìã Include comprehensive response templates for different sentiment types");
            } else {
                suggestions.intelligence.push("üéâ Excellent sentiment analysis! Very comprehensive and actionable");
            }

            // Automation Setup
            const automationPercentage = (scores.automation / 25) * 100;
            suggestions.automation = [];
            
            if (automationPercentage < 60) {
                suggestions.automation.push("üîÑ Design complete workflows for both customer support AND social media monitoring");
                suggestions.automation.push("‚ö° Include clear triggers, numbered steps, and specific escalation rules");
                suggestions.automation.push("üéØ Add routing logic and automated response templates");
            } else if (automationPercentage < 80) {
                suggestions.automation.push("üîß Enhance escalation rules with specific conditions and thresholds");
                suggestions.automation.push("üì± Add more detailed social media monitoring and crisis detection");
            } else {
                suggestions.automation.push("üéâ Excellent automation design! Well-structured and comprehensive workflows");
            }

            // Data Quality
            const qualityPercentage = (scores.quality / 20) * 100;
            suggestions.quality = [];
            
            if (qualityPercentage < 60) {
                suggestions.quality.push("‚úÖ Perform systematic consistency checks across all translations and technical specs");
                suggestions.quality.push("üìä Include translation quality scores in X/10 format for each language");
                suggestions.quality.push("üö® Identify and document critical issues that could impact launch");
            } else if (qualityPercentage < 80) {
                suggestions.quality.push("üîç Add more detailed validation of pricing and technical specifications");
                suggestions.quality.push("üìà Include average quality calculations and specific improvement recommendations");
            } else {
                suggestions.quality.push("üéâ Outstanding quality assurance! Thorough and systematic validation");
            }

            return suggestions;
        }

        // Enhanced main scoring function with loading states
        async function startAutoScoring() {
            const startTime = performance.now();
            const button = event.target;
            
            // Add loading state
            button.classList.add('loading');
            button.disabled = true;
            
            try {
                const inputs = {
                    translations: document.getElementById('translations').value,
                    linkedin: document.getElementById('linkedin').value,
                    sentiment: document.getElementById('sentiment').value,
                    workflows: document.getElementById('workflows').value,
                    validation: document.getElementById('validation').value
                };

                // Validate inputs
                const emptyFields = Object.keys(inputs).filter(key => !inputs[key].trim());
                if (emptyFields.length > 0) {
                    showNotification(`‚ö†Ô∏è Please fill in: ${emptyFields.join(', ')}`, 'warning');
                    return;
                }

                // Score each category
                const results = {
                    content: scoreContentQuality(inputs.translations, inputs.linkedin),
                    intelligence: scoreCustomerIntelligence(inputs.sentiment),
                    automation: scoreAutomationSetup(inputs.workflows),
                    quality: scoreDataQuality(inputs.validation)
                };

                // Update unified data structure
                assessmentData.scores = {
                    content: results.content.score,
                    intelligence: results.intelligence.score,
                    automation: results.automation.score,
                    quality: results.quality.score,
                    total: results.content.score + results.intelligence.score + results.automation.score + results.quality.score
                };

                assessmentData.debug = {
                    content: results.content.debug,
                    intelligence: results.intelligence.debug,
                    automation: results.automation.debug,
                    quality: results.quality.debug
                };

                assessmentData.suggestions = generateSuggestions();
                assessmentData.metadata = {
                    timestamp: new Date().toISOString(),
                    processingTime: performance.now() - startTime
                };

                // Display results with animation
                await displayResults();
                displaySuggestions();
                
                document.getElementById('scoring-results').style.display = 'block';
                showNotification('‚úÖ Scoring completed successfully!', 'success');
                
            } catch (error) {
                console.error('Scoring error:', error);
                showNotification('‚ùå Scoring failed. Please try again.', 'error');
            } finally {
                button.classList.remove('loading');
                button.disabled = false;
            }
        }

        // Enhanced display with smooth animations
        async function displayResults() {
            const scores = assessmentData.scores;
            const maxScores = { content: 30, intelligence: 25, automation: 25, quality: 20 };

            function formatScore(score, max) {
                const percentage = ((score / max) * 100).toFixed(1);
                const icons = { 80: '‚ú®', 60: '‚úÖ', 40: '‚ö†Ô∏è', 0: '‚ùå' };
                const icon = Object.keys(icons).reverse().find(threshold => percentage >= threshold);
                return `${score}/${max} (${percentage}%)${icons[icon]}`;
            }

            // Update individual scores with animation
            const scoreElements = ['content', 'intelligence', 'automation', 'quality'];
            scoreElements.forEach((category, index) => {
                setTimeout(() => {
                    const element = document.getElementById(`${category}-points`);
                    element.textContent = formatScore(scores[category], maxScores[category]);
                    element.style.animation = 'fadeIn 0.5s ease';
                }, index * 200);
            });

            // Animate overall score circle
            setTimeout(() => {
                const totalMax = Object.values(maxScores).reduce((a, b) => a + b, 0);
                const overallPercentage = ((scores.total / totalMax) * 100).toFixed(1);
                const scoreCircle = document.getElementById('overall-score');
                
                scoreCircle.innerHTML = `
                    <div style="font-size: 24px; font-weight: bold;">${scores.total}</div>
                    <div style="font-size: 12px; margin-top: -5px;">/${totalMax}</div>
                    <div style="font-size: 14px; margin-top: 2px;">${overallPercentage}%</div>
                `;

                // Enhanced color coding with gradients
                const colorSchemes = {
                    85: { bg: 'linear-gradient(135deg, #27ae60, #2ecc71)', shadow: 'rgba(39, 174, 96, 0.4)' },
                    70: { bg: 'linear-gradient(135deg, #3498db, #5dade2)', shadow: 'rgba(52, 152, 219, 0.4)' },
                    55: { bg: 'linear-gradient(135deg, #f39c12, #f4d03f)', shadow: 'rgba(243, 156, 18, 0.4)' },
                    0: { bg: 'linear-gradient(135deg, #e74c3c, #ec7063)', shadow: 'rgba(231, 76, 60, 0.4)' }
                };

                const scheme = Object.keys(colorSchemes).reverse().find(threshold => overallPercentage >= threshold);
                const colors = colorSchemes[scheme];
                
                scoreCircle.style.background = colors.bg;
                scoreCircle.style.color = 'white';
                scoreCircle.style.boxShadow = `0 8px 25px ${colors.shadow}`;

                // Launch decision with enhanced messaging
                const decisions = {
                    85: { text: 'ü•á LAUNCH HERO - Proceed with launch! $2M secured.', advice: 'Outstanding work across all categories!' },
                    70: { text: 'ü•à LAUNCH SAVER - Minor fixes needed, 24-hour delay.', advice: 'Address highlighted issues and you\'ll be ready.' },
                    55: { text: 'ü•â CRISIS MANAGER - Major fixes required, 1-week delay.', advice: 'Focus on lowest-scoring categories first.' },
                    0: { text: '‚ùå MISSION FAILED - Extensive rework needed.', advice: 'Review suggestions and rebuild systematically.' }
                };

                const decision = Object.keys(decisions).reverse().find(threshold => overallPercentage >= threshold);
                const result = decisions[decision];
                
                document.getElementById('launch-decision').innerHTML = `
                    <div style="font-size: 18px; font-weight: bold; margin-bottom: 8px;">${result.text}</div>
                    <div style="font-size: 14px; font-style: italic; opacity: 0.8;">${result.advice}</div>
                `;

                // Color code individual items
                scoreElements.forEach(category => {
                    colorCodeScoreItem(`${category}-score`, scores[category], maxScores[category]);
                });
            }, 800);
        }

        function colorCodeScoreItem(elementId, score, maxScore) {
            const element = document.getElementById(elementId);
            const percentage = (score / maxScore) * 100;
            const classes = ['score-excellent', 'score-good', 'score-warning', 'score-poor'];
            const thresholds = [80, 60, 40, 0];
            
            const classIndex = thresholds.findIndex(threshold => percentage >= threshold);
            element.className = `score-item ${classes[classIndex]}`;
        }

        function displaySuggestions() {
            const suggestions = assessmentData.suggestions;
            const scores = assessmentData.scores;
            const maxScores = { content: 30, intelligence: 25, automation: 25, quality: 20 };

            Object.keys(suggestions).forEach(category => {
                const element = document.getElementById(`${category}-improvements`);
                const suggestionClass = getSuggestionClass(scores[category], maxScores[category]);
                
                element.innerHTML = suggestions[category].join('<br>');
                element.className = `improvement-suggestions ${suggestionClass}`;
            });
        }

        // Enhanced debug panel
        function toggleDebug() {
            const debugDiv = document.getElementById('debug-info');
            const debugContent = document.getElementById('debug-content');
            const button = event.target;

            if (debugDiv.style.display === 'none') {
                let debugText = '<h3 style="color: #2c3e50; margin-bottom: 20px;">üîç Detailed Scoring Breakdown</h3>';
                
                Object.keys(assessmentData.debug).forEach(category => {
                    debugText += `<div class="debug-section">`;
                    debugText += `<h4 style="color: #3498db; margin-bottom: 10px;">${category.charAt(0).toUpperCase() + category.slice(1)} Quality</h4>`;
                    assessmentData.debug[category].forEach(item => {
                        debugText += `<div style="margin: 5px 0; padding: 5px; background: #f8f9fa; border-radius: 4px;">‚Ä¢ ${item}</div>`;
                    });
                    debugText += '</div>';
                });

                debugText += `<div class="debug-section">`;
                debugText += `<h4 style="color: #3498db;">Performance Metrics</h4>`;
                debugText += `<div>Processing Time: ${assessmentData.metadata.processingTime?.toFixed(2)}ms</div>`;
                debugText += `<div>Cache Hits: ${scoringCache.size}</div>`;
                debugText += `<div>Timestamp: ${assessmentData.metadata.timestamp}</div>`;
                debugText += '</div>';

                debugContent.innerHTML = debugText;
                debugDiv.style.display = 'block';
                button.textContent = 'üîß Hide Debug Info';
            } else {
                debugDiv.style.display = 'none';
                button.textContent = 'üîß Show Debug Info';
            }
        }

        // Enhanced export with CSV option
        function exportResults() {
            const data = {
                ...assessmentData,
                teamName: prompt('Enter your team name:') || 'Anonymous Team'
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ecotech_assessment_${data.teamName.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            showNotification('üìã Results exported successfully!', 'success');
        }

        // New report generation feature
        function generateReport() {
            const scores = assessmentData.scores;
            const totalMax = 100;
            const percentage = ((scores.total / totalMax) * 100).toFixed(1);
            
            const report = `
# EcoTech Assessment Report

**Team Assessment Date:** ${new Date().toLocaleDateString()}
**Overall Score:** ${scores.total}/100 (${percentage}%)

## Category Breakdown
- üåç Content Quality: ${scores.content}/30 (${((scores.content/30)*100).toFixed(1)}%)
- üí¨ Customer Intelligence: ${scores.intelligence}/25 (${((scores.intelligence/25)*100).toFixed(1)}%)
- ‚ö° Automation Setup: ${scores.automation}/25 (${((scores.automation/25)*100).toFixed(1)}%)
- üîç Data Quality: ${scores.quality}/20 (${((scores.quality/20)*100).toFixed(1)}%)

## Key Recommendations
${Object.values(assessmentData.suggestions).flat().map(s => `- ${s}`).join('\n')}

## Performance Metrics
- Processing Time: ${assessmentData.metadata.processingTime?.toFixed(2)}ms
- Assessment Completed: ${assessmentData.metadata.timestamp}
            `.trim();
            
            const blob = new Blob([report], {type: 'text/markdown'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ecotech_report_${new Date().toISOString().split('T')[0]}.md`;
            a.click();
            
            showNotification('üìä Report generated successfully!', 'success');
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 1000; padding: 12px 20px;
                border-radius: 8px; color: white; font-weight: 500; max-width: 300px;
                animation: slideIn 0.3s ease; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            `;
            
            const colors = {
                success: '#27ae60', warning: '#f39c12', error: '#e74c3c', info: '#3498db'
            };
            notification.style.background = colors[type] || colors.info;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
            @keyframes slideOut { from { transform: translateX(0); opacity: 1; } to { transform: translateX(100%); opacity: 0; } }
        `;
        document.head.appendChild(style);

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            showNotification('üöÄ EcoTech Auto-Scorer Pro loaded successfully!', 'success');
        });
    </script>
</body>
</html>
